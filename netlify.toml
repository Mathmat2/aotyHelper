[build]
  command = "npm run build"
  publish = ".next"

[[plugins]]
  package = "@netlify/plugin-nextjs"

[functions]
  # Increase timeout for functions (default is 10s, max is 26s for free tier)
  # This is important for the Last.fm API calls which can take time
  node_bundler = "esbuild"
  
[build.environment]
  # Ensure better-sqlite3 is built for the correct platform
  NPM_FLAGS = "--legacy-peer-deps"
